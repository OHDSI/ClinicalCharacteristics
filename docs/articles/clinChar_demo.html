<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>How to use ClinicalCharacteristics • ClinicalCharacteristics</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="How to use ClinicalCharacteristics">
<meta property="og:description" content="ClinicalCharacteristics">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">ClinicalCharacteristics</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.0.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/clinChar_demo.html">How to use ClinicalCharacteristics</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>How to use ClinicalCharacteristics</h1>
                        <h4 data-toc-skip class="author">Martin
Lavallee</h4>
                        <h4 data-toc-skip class="author">Katy
Sadowski</h4>
                        <h4 data-toc-skip class="author">Ajit
Londhe</h4>
                        <h4 data-toc-skip class="author">Ron
Herrera</h4>
            
      
      
      <div class="hidden name"><code>clinChar_demo.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>When conducting real-world evidence (RWE) studies, analysts often
need to populate table-shells defined by clinical colleagues. In
principle, these table-shells should be simple to generate, as they
consist primarily of counts and percentages for categorical variables
and summary statistics for continuous variables. Surprisingly, this task
proves to be non-trivial when using the available OHDSI tools. The best
available tool for characterization is <code>FeatureExtraction</code>
which is a tool designed to extract as many clinical features as
possible to use as covariates for high-dimensional modelling. While
helpful for modelling, populating table-shells is awkward because it
pulls all concepts from a domain and performs characterization at the
individual concept level. One could also use the web application ATLAS
to characterize, but it does not fit programmatic driven pipelines. With
some of these gaps in mind, we designed a new OHDSI tool titled
<code>ClinicalCharacteristics</code>, which is a table shell approach to
OMOP characterization.</p>
</div>
<div class="section level2">
<h2 id="features">Features<a class="anchor" aria-label="anchor" href="#features"></a>
</h2>
<p>A characterization requires the identification of a clinical event
during a specified window of time relative to the index date of the
cohort of interest. For example, if we wish to look at baseline
characteristics, we anchor our enumeration on the date at which the
person enters the cohort and consider a window of time as baseline (say
-365 days to -1 days relative to index). There are a few assumptions we
need to make from this construction: a) what type of event are we
looking for, b) when are we looking, relative to index, and must it be
during observed time and c) how do we want to summarize this
information.</p>
<div class="section level3">
<h3 id="data-types">Data Types<a class="anchor" aria-label="anchor" href="#data-types"></a>
</h3>
<p><code>ClinicalCharacteristics</code> can summarize the following
types of OHDSI objects:</p>
<ul>
<li>
<strong>Demographics</strong>: information rooted in the person
table such as age, gender, race, and ethnicity.</li>
<li>
<strong>Concept Sets</strong>: groupings of concepts in a single
domain, applying hierarchical logic to identify large lists of clinical
concepts. For example, a Type 2 Diabetes concept set would include the
high-level concept and its descendants.</li>
<li>
<strong>Concept Set Groups</strong>: groups of concepts across
multiple domains. Sometimes concepts for an occurrence do not occur in
one domain (i.e conditions, drugs, procedures) but in multiple. For
example, smoking status occurs in observation, procedure, and condition
tables. This item unifies them as a single entity.</li>
<li>
<strong>Cohorts</strong>: identification of a clinical event across
a set of persons over an era of time bracketed by an entry and exit
event. Cohorts apply the occurrence of an event accounting for attrition
based on inclusion/exclusion criteria.</li>
<li>
<strong>Source Codes</strong>: a list of non-standard codes under a
single vocabulary to identify events. It is not recommended to use this
type of object because it does not leverage the advantages of semantic
standardization</li>
<li>
<strong>Other</strong>: [Future Addition] Sometimes clinically
relevant events don’t fall into the these categories and require special
constructions to query in the CDM. Items such as lab measurements,
locations, and episodes.</li>
</ul>
</div>
<div class="section level3">
<h3 id="value-types">Value Types<a class="anchor" aria-label="anchor" href="#value-types"></a>
</h3>
<p>Beyond types of domains to summarize, there are different ways of
performing an aggregation of information.
<code>ClinicalCharacteristics</code> can create tables based on these
value types:</p>
<ul>
<li>
<strong>Presence</strong>: an event is either observed or not
observed for a patient given a time window. With this statistic type we
report a categorical value as n and percent.</li>
<li>
<strong>Continuous Distribution</strong>: how many times is an event
or measured value observed during a period of time. With this statistic
type we report as a continuous value using mean, standard deviation and
default order statistics.</li>
<li>
<strong>Breaks</strong>: sometimes we want to convert a continuous
value into a categorical grouping. For example, persons taking 1, 2, 3,
or 4+ medications during a period of time. We apply breaks to categorize
counts and report as a categorical value with n and percent.</li>
<li>
<strong>Score</strong>: the inverse of breaks, we may want to turn a
categorical grouping into a continuous value. For example we wish to
apply a weight to the presence of an event and the summarize a
collection of scores per patient.</li>
</ul>
</div>
<div class="section level3">
<h3 id="observed-time">Observed Time<a class="anchor" aria-label="anchor" href="#observed-time"></a>
</h3>
<p>Another consideration is whether to summarize occurrence based on any
time or observed time. When we define a time window for characterization
this does not consider whether the persons were under continuous
observation. To add this feature in we need to specify to count only
persons who were actively followed during the interval in both the
numerator and denominator. <code>ClinicalCharacteristics</code>
specifies if we enumerate at <strong>any</strong> time (naively apply
the time window) or <strong>observed</strong> (apply the time window in
the context of observed time). It is recommended to use
<strong>any</strong> time for most characterization, as it is the
simplest to interpret.</p>
</div>
</div>
<div class="section level2">
<h2 id="setup">Setup<a class="anchor" aria-label="anchor" href="#setup"></a>
</h2>
<div class="section level3">
<h3 id="execution-settings">Execution Settings<a class="anchor" aria-label="anchor" href="#execution-settings"></a>
</h3>
<p>As do all OHDSI tools we need to setup the database credentials of
the dbms hosting the OMOP data we wish to use with
<code>ClinicalCharacteristics</code>. We use the HADES package <a href="https://ohdsi.github.io/DatabaseConnector/" class="external-link"><code>DatabaseConnector</code></a>
to create a <code>connectionDetails</code> object that can be used to
establish a database connection. Below we provide an example of setting
up connection details, where users can find more references from the
<code>DatabaseConnector</code> documentation.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># set a environment variable defining the jar folder path</span></span>
<span><span class="co">#Sys.setenv("DATABASECONNECTOR_JAR_FOLDER" = "c:/temp/jdbcDrivers")</span></span>
<span></span>
<span><span class="co"># download the jdbc driver</span></span>
<span><span class="fu">DatabaseConnector</span><span class="fu">::</span><span class="fu"><a href="https://ohdsi.github.io/DatabaseConnector/reference/downloadJdbcDrivers.html" class="external-link">downloadJdbcDrivers</a></span><span class="op">(</span><span class="st">"postgresql"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">connectionDetails</span> <span class="op">&lt;-</span> <span class="fu">DatabaseConnector</span><span class="fu">::</span><span class="fu"><a href="https://ohdsi.github.io/DatabaseConnector/reference/createConnectionDetails.html" class="external-link">createConnectionDetails</a></span><span class="op">(</span></span>
<span>  dbms <span class="op">=</span> <span class="st">"postgresql"</span>,</span>
<span>  user <span class="op">=</span> <span class="st">"joe"</span>,</span>
<span>  password <span class="op">=</span> <span class="st">"secret"</span>,</span>
<span>  connectionString <span class="op">=</span> <span class="st">"jdbc:postgresql://localhost:5432/postgres"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># test the connection</span></span>
<span><span class="va">con</span> <span class="op">&lt;-</span> <span class="fu">DatabaseConnector</span><span class="fu">::</span><span class="fu"><a href="https://ohdsi.github.io/DatabaseConnector/reference/connect.html" class="external-link">connect</a></span><span class="op">(</span><span class="va">connectionDetails</span><span class="op">)</span></span>
<span><span class="fu">DatabaseConnector</span><span class="fu">::</span><span class="fu"><a href="https://ohdsi.github.io/DatabaseConnector/reference/disconnect.html" class="external-link">disconnect</a></span><span class="op">(</span><span class="va">con</span><span class="op">)</span></span></code></pre></div>
<p>Something we are introducing within the
<code>ClinicalCharacteristics</code> package is a class called
<code>ExecutionSettings</code>. This object maintains all the settings
needed to execute a query on your dbms. Key parameters include:</p>
<ul>
<li>
<strong>cdmDatabaseSchema</strong>: a read only schema where the
OMOP CDM is located</li>
<li>
<strong>workDatabaseSchema</strong>: a read/write schema where you
will conduct work; effectively the location of the cohort table</li>
<li>
<strong>tempEmulationSchema</strong>: a read/write schema to store
temp tables. Note this is only necessary for dbms’ like snowflake and
oracle that handle temp tables differently than other dialects</li>
<li>
<strong>cohortTable</strong>: the name of the cohort table where
your target cohorts exist</li>
<li>
<strong>cdmSourceName</strong>: a label for the CDM in use</li>
</ul>
<p>In <code>ClinicalCharacteristics</code> we can set up our execution
settings object as follows:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">ClinicalCharacteristics</span><span class="op">)</span></span>
<span></span>
<span><span class="va">executionSettings</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/createExecutionSettings.html">createExecutionSettings</a></span><span class="op">(</span></span>
<span>  connectionDetails <span class="op">=</span> <span class="va">connectionDetails</span>,</span>
<span>  cdmDatabaseSchema <span class="op">=</span> <span class="st">"omop_schema"</span>,</span>
<span>  workDatabaseSchema <span class="op">=</span> <span class="st">"my_schema"</span>,</span>
<span>  tempEmulationSchema <span class="op">=</span> <span class="st">"my_schema"</span>,</span>
<span>  cohortTable <span class="op">=</span> <span class="st">"my_cohorts"</span>,</span>
<span>  cdmSourceName <span class="op">=</span> <span class="st">"my_omop"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>The convenience of this object is that it serves as a container to
pass parameters to steps that execute the sql. Note that users also do
not need to worry about opening and closing connections when using these
tools.</p>
<p>Replacing parameters in the executionSettings object is done through
simple assignment:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">executionSettings</span><span class="op">$</span><span class="va">cdmSourceName</span> <span class="op">&lt;-</span> <span class="st">"my_other_omop"</span></span>
<span><span class="va">executionSettings</span><span class="op">$</span><span class="va">workDatabaseSchema</span> <span class="op">&lt;-</span> <span class="st">"my_other_schema"</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="cohorts">Cohorts<a class="anchor" aria-label="anchor" href="#cohorts"></a>
</h3>
<p><code>ClinicalCharacteristics</code> works under the assumption that
cohorts have already been instantiated in the cohort table. For new
OHDSI users, please review the <code>CohortGenerator</code> <a href="https://ohdsi.github.io/CohortGenerator/articles/GeneratingCohorts.html" class="external-link">package</a>
on how to instantiate cohorts in the cohort table.</p>
</div>
<div class="section level3">
<h3 id="concept-sets">Concept Sets<a class="anchor" aria-label="anchor" href="#concept-sets"></a>
</h3>
<p>Our key distinguishing feature to the <code>FeatureExtraction</code>
package is the ability to characterize using concept sets as opposed to
individual concept ids. There are two ways to import concept sets into
the <code>ClinicalCharacteristics</code> work flow: a) import from json
or b) create on the fly. Both methods apply the R package <a href="https://github.com/OHDSI/Capr" class="external-link"><code>Capr</code></a>.</p>
<div class="section level4">
<h4 id="import-from-json">Import from Json<a class="anchor" aria-label="anchor" href="#import-from-json"></a>
</h4>
<p>Users can export a concept set definition json from ATLAS and save as
a file with json extension. To import the concept set into R as an
object do as follows:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">conceptSetFile</span> <span class="op">&lt;-</span> <span class="fu">here</span><span class="fu">::</span><span class="fu"><a href="https://here.r-lib.org/reference/here.html" class="external-link">here</a></span><span class="op">(</span><span class="st">"my_concept_set.json"</span><span class="op">)</span></span>
<span><span class="va">cs1</span> <span class="op">&lt;-</span> <span class="fu">Capr</span><span class="fu">::</span><span class="fu"><a href="https://ohdsi.github.io/Capr/reference/readConceptSet.html" class="external-link">readConceptSet</a></span><span class="op">(</span></span>
<span>  path <span class="op">=</span> <span class="va">conceptSetFile</span>,</span>
<span>  name <span class="op">=</span> <span class="st">"My Concept Set"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>We recommend using this method if you have complex concept sets.</p>
</div>
<div class="section level4">
<h4 id="create-on-the-fly">Create on the Fly<a class="anchor" aria-label="anchor" href="#create-on-the-fly"></a>
</h4>
<p>Users can also use <code>Capr</code> to create a simple concept set
using the standard concept id of interest.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cs2</span> <span class="op">&lt;-</span> <span class="fu">Capr</span><span class="fu">::</span><span class="fu"><a href="https://ohdsi.github.io/Capr/reference/cs.html" class="external-link">cs</a></span><span class="op">(</span><span class="fu">Capr</span><span class="fu">::</span><span class="fu"><a href="https://ohdsi.github.io/Capr/reference/cs.html" class="external-link">descendants</a></span><span class="op">(</span><span class="fl">201826</span><span class="op">)</span>, name <span class="op">=</span> <span class="st">"t2d"</span><span class="op">)</span></span></code></pre></div>
<p>This function creates a concept set class in Capr. We take the
standard concept for type 2 diabetes and include its descendants to make
a concept set. We recommend this method when building simple concept
sets.</p>
</div>
</div>
</div>
<div class="section level2">
<h2 id="using-clinicalcharacteristics">Using ClinicalCharacteristics<a class="anchor" aria-label="anchor" href="#using-clinicalcharacteristics"></a>
</h2>
<p>Now that we have setup the requirements for
<code>ClinicalCharacteristics</code>, we can begin to use the program to
develop table shells. The goal is to populate a <code>TableShell</code>
class object with the details of how you want to populate your table.
The key elements of the table shell are: the title, the target cohorts
to use and the table line items.</p>
<div class="section level3">
<h3 id="target-cohorts">Target Cohorts<a class="anchor" aria-label="anchor" href="#target-cohorts"></a>
</h3>
<p>First we must specify which cohorts we want to characterize in our
shell. Assuming they have been instantiated in a specific cohort table,
we can load them as follows:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">targetCohorts</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="../reference/createCohortInfo.html">createCohortInfo</a></span><span class="op">(</span>id <span class="op">=</span> <span class="fl">1</span>, name <span class="op">=</span> <span class="st">"T2D"</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="../reference/createCohortInfo.html">createCohortInfo</a></span><span class="op">(</span>id <span class="op">=</span> <span class="fl">2</span>, name <span class="op">=</span> <span class="st">"T1D"</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p>We list all the cohorts we want to use. You may add as many
instantiated cohorts as you would like into this list and
<code>ClinicalCharacteristics</code> will render the same table shell
per target cohort.</p>
</div>
<div class="section level3">
<h3 id="line-items">Line Items<a class="anchor" aria-label="anchor" href="#line-items"></a>
</h3>
<p>Each element of the table is called a line item. The line item
uniquely summarizes events with a particular statistic type at a
specified time window. For example, if we want to characterize CKD we
need to specify the line item:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ckd_cs</span> <span class="op">&lt;-</span> <span class="fu">Capr</span><span class="fu">::</span><span class="fu"><a href="https://ohdsi.github.io/Capr/reference/cs.html" class="external-link">cs</a></span><span class="op">(</span><span class="fu">Capr</span><span class="fu">::</span><span class="fu"><a href="https://ohdsi.github.io/Capr/reference/cs.html" class="external-link">descendants</a></span><span class="op">(</span><span class="fl">46271022</span><span class="op">)</span>, name <span class="op">=</span> <span class="st">"ckd"</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/createConceptSetLineItem.html">createConceptSetLineItem</a></span><span class="op">(</span></span>
<span>  sectionLabel <span class="op">=</span> <span class="st">"CKD: Baseline"</span>,</span>
<span>  domain <span class="op">=</span> <span class="st">"condition_occurrence"</span>,</span>
<span>  statistic <span class="op">=</span> <span class="fu"><a href="../reference/anyPresenceStat.html">anyPresenceStat</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  conceptSet <span class="op">=</span> <span class="va">ckd_cs</span>,</span>
<span>  timeInterval <span class="op">=</span> <span class="va">tw1</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>The section label specifies how we want to identify the line item
within the table as a section. The domain must specify which domain
table in the CDM we should check for events. Because CKD is a condition,
we want to check the <em>condition_occurrence</em> table. If we were
characterizing drugs we would check the <em>drug_exposure</em> table.
Review the <a href="https://ohdsi.github.io/CommonDataModel/cdm54.html#Current_Support_for_CDM_v54" class="external-link">OMOP
CDM</a> to become familiar with the different types of domains.</p>
<p>The statistic determines how to summarize the event; here are
examples:</p>
<ul>
<li>
<code>PresenceStat</code>: determine who had an occurrence of an
event during an interval</li>
<li>
<code>CountCtsStat</code>: determine the continuous distribution of
an event during an interval</li>
<li>
<code>CountBreaksStat</code>: convert the count to breaks of an
event during an interval</li>
<li>
<code>TimeToFirst</code>: determine the continuous distribution of
the time to the occurrence of the first event</li>
</ul>
<p>To distinguish between <strong>any</strong> and
<strong>observed</strong>, add the keyword as a prefix
(i.e. <code><a href="../reference/anyPresenceStat.html">anyPresenceStat()</a></code> or
<code><a href="../reference/observedPresenceStat.html">observedPresenceStat()</a></code>).</p>
</div>
<div class="section level3">
<h3 id="basic-example">Basic Example<a class="anchor" aria-label="anchor" href="#basic-example"></a>
</h3>
<p>Let’s use the following details for an example table shell, assuming
a cohort for type 2 diabetes has been created:</p>
<ul>
<li>male gender</li>
<li>age as continuous</li>
<li>presence of condition ckd -365d to -1d prior to index</li>
<li>presence of condition t2d -365d to -1d prior to index</li>
<li>presence of drug sglt2 0d to 90d post index</li>
</ul>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">ClinicalCharacteristics</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Define Execution Settings</span></span>
<span><span class="va">executionSettings</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/createExecutionSettings.html">createExecutionSettings</a></span><span class="op">(</span></span>
<span>  connectionDetails <span class="op">=</span> <span class="va">connectionDetails</span>,</span>
<span>  cdmDatabaseSchema <span class="op">=</span> <span class="st">"omop_schema"</span>,</span>
<span>  workDatabaseSchema <span class="op">=</span> <span class="st">"my_schema"</span>,</span>
<span>  tempEmulationSchema <span class="op">=</span> <span class="st">"my_schema"</span>,</span>
<span>  cohortTable <span class="op">=</span> <span class="st">"my_cohorts"</span>,</span>
<span>  cdmSourceName <span class="op">=</span> <span class="st">"my_omop"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># create each concept set</span></span>
<span><span class="va">ckd_cs</span> <span class="op">&lt;-</span> <span class="fu">Capr</span><span class="fu">::</span><span class="fu"><a href="https://ohdsi.github.io/Capr/reference/cs.html" class="external-link">cs</a></span><span class="op">(</span><span class="fu">Capr</span><span class="fu">::</span><span class="fu"><a href="https://ohdsi.github.io/Capr/reference/cs.html" class="external-link">descendants</a></span><span class="op">(</span><span class="fl">46271022</span><span class="op">)</span>, name <span class="op">=</span> <span class="st">"ckd"</span><span class="op">)</span></span>
<span><span class="va">hf_cs</span> <span class="op">&lt;-</span> <span class="fu">Capr</span><span class="fu">::</span><span class="fu"><a href="https://ohdsi.github.io/Capr/reference/cs.html" class="external-link">cs</a></span><span class="op">(</span><span class="fu">Capr</span><span class="fu">::</span><span class="fu"><a href="https://ohdsi.github.io/Capr/reference/cs.html" class="external-link">descendants</a></span><span class="op">(</span><span class="fl">316139</span><span class="op">)</span>, name <span class="op">=</span> <span class="st">"hf"</span><span class="op">)</span></span>
<span><span class="va">sglt2_cs</span> <span class="op">&lt;-</span> <span class="fu">Capr</span><span class="fu">::</span><span class="fu"><a href="https://ohdsi.github.io/Capr/reference/cs.html" class="external-link">cs</a></span><span class="op">(</span><span class="fu">Capr</span><span class="fu">::</span><span class="fu"><a href="https://ohdsi.github.io/Capr/reference/cs.html" class="external-link">descendants</a></span><span class="op">(</span><span class="fl">1123627</span><span class="op">)</span>, name <span class="op">=</span> <span class="st">"sglt2"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># make each time window</span></span>
<span><span class="va">tw1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/timeInterval.html">timeInterval</a></span><span class="op">(</span>lb <span class="op">=</span> <span class="op">-</span><span class="fl">365</span>, rb <span class="op">=</span> <span class="op">-</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">tw2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/timeInterval.html">timeInterval</a></span><span class="op">(</span>lb <span class="op">=</span> <span class="fl">0</span>, rb <span class="op">=</span> <span class="fl">90</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># define table shell</span></span>
<span><span class="va">ts</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/createTableShell.html">createTableShell</a></span><span class="op">(</span></span>
<span>  title <span class="op">=</span> <span class="st">"Demo 1"</span>,</span>
<span>  targetCohorts <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="../reference/createCohortInfo.html">createCohortInfo</a></span><span class="op">(</span>id <span class="op">=</span> <span class="fl">1</span>, name <span class="op">=</span> <span class="st">"Type 2 Diabetes"</span><span class="op">)</span></span>
<span>  <span class="op">)</span>,</span>
<span>  lineItems <span class="op">=</span> <span class="fu"><a href="../reference/lineItems.html">lineItems</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="../reference/createDemographicLineItem.html">createDemographicLineItem</a></span><span class="op">(</span><span class="fu"><a href="../reference/maleGender.html">maleGender</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="../reference/createDemographicLineItem.html">createDemographicLineItem</a></span><span class="op">(</span><span class="fu"><a href="../reference/ageCharCts.html">ageCharCts</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="../reference/createConceptSetLineItem.html">createConceptSetLineItem</a></span><span class="op">(</span></span>
<span>      sectionLabel <span class="op">=</span> <span class="st">"CKD: Baseline"</span>,</span>
<span>      domain <span class="op">=</span> <span class="st">"condition_occurrence"</span>,</span>
<span>      statistic <span class="op">=</span> <span class="fu"><a href="../reference/anyPresenceStat.html">anyPresenceStat</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>      conceptSet <span class="op">=</span> <span class="va">ckd_cs</span>,</span>
<span>      timeInterval <span class="op">=</span> <span class="va">tw1</span></span>
<span>    <span class="op">)</span>,</span>
<span>    <span class="fu"><a href="../reference/createConceptSetLineItem.html">createConceptSetLineItem</a></span><span class="op">(</span></span>
<span>      sectionLabel <span class="op">=</span> <span class="st">"HF: Baseline"</span>,</span>
<span>      domain <span class="op">=</span> <span class="st">"condition_occurrence"</span>,</span>
<span>      statistic <span class="op">=</span> <span class="fu"><a href="../reference/anyPresenceStat.html">anyPresenceStat</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>      conceptSet <span class="op">=</span> <span class="va">hf_cs</span>,</span>
<span>      timeInterval <span class="op">=</span> <span class="va">tw1</span></span>
<span>    <span class="op">)</span>,</span>
<span>    <span class="fu"><a href="../reference/createConceptSetLineItem.html">createConceptSetLineItem</a></span><span class="op">(</span></span>
<span>      sectionLabel <span class="op">=</span> <span class="st">"SGLT2: Post Index"</span>,</span>
<span>      domain <span class="op">=</span> <span class="st">"drug_exposure"</span>,</span>
<span>      statistic <span class="op">=</span> <span class="fu"><a href="../reference/anyPresenceStat.html">anyPresenceStat</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>      conceptSet <span class="op">=</span> <span class="va">sglt2_cs</span>,</span>
<span>      timeInterval <span class="op">=</span> <span class="va">tw2</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/generateTableShell.html">generateTableShell</a></span><span class="op">(</span><span class="va">ts</span>, <span class="va">executionSettings</span><span class="op">)</span></span>
<span><span class="va">res</span><span class="op">$</span><span class="va">categorical</span></span>
<span><span class="va">res</span><span class="op">$</span><span class="va">continuous</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="conveniences">Conveniences<a class="anchor" aria-label="anchor" href="#conveniences"></a>
</h3>
<p>Line items are an important feature of
<code>ClinicalCharacteristics</code> in order to track the table shell
in a consistent matter. However, from a UI perspective this becomes very
“typing” intensive. So we have added certain convenience functions to
make it easier to design the table shell. Taking the same example from
above, what if we added the following to our table shell:</p>
<ul>
<li>female gender</li>
<li>ethnicity categories</li>
<li>race categories</li>
<li>age in 5-year breaks</li>
<li>sglt2 and glp1 at 0-90 and 0-365 days post index</li>
</ul>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">ClinicalCharacteristics</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Define Execution Settings</span></span>
<span><span class="va">executionSettings</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/createExecutionSettings.html">createExecutionSettings</a></span><span class="op">(</span></span>
<span>  connectionDetails <span class="op">=</span> <span class="va">connectionDetails</span>,</span>
<span>  cdmDatabaseSchema <span class="op">=</span> <span class="st">"omop_schema"</span>,</span>
<span>  workDatabaseSchema <span class="op">=</span> <span class="st">"my_schema"</span>,</span>
<span>  tempEmulationSchema <span class="op">=</span> <span class="st">"my_schema"</span>,</span>
<span>  cohortTable <span class="op">=</span> <span class="st">"my_cohorts"</span>,</span>
<span>  cdmSourceName <span class="op">=</span> <span class="st">"my_omop"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># create each concept set</span></span>
<span><span class="va">condition_cs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  <span class="fu">Capr</span><span class="fu">::</span><span class="fu"><a href="https://ohdsi.github.io/Capr/reference/cs.html" class="external-link">cs</a></span><span class="op">(</span><span class="fu">Capr</span><span class="fu">::</span><span class="fu"><a href="https://ohdsi.github.io/Capr/reference/cs.html" class="external-link">descendants</a></span><span class="op">(</span><span class="fl">46271022</span><span class="op">)</span>, name <span class="op">=</span> <span class="st">"ckd"</span><span class="op">)</span>,</span>
<span>  <span class="fu">Capr</span><span class="fu">::</span><span class="fu"><a href="https://ohdsi.github.io/Capr/reference/cs.html" class="external-link">cs</a></span><span class="op">(</span><span class="fu">Capr</span><span class="fu">::</span><span class="fu"><a href="https://ohdsi.github.io/Capr/reference/cs.html" class="external-link">descendants</a></span><span class="op">(</span><span class="fl">316139</span><span class="op">)</span>, name <span class="op">=</span> <span class="st">"hf"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">drug_cs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  <span class="fu">Capr</span><span class="fu">::</span><span class="fu"><a href="https://ohdsi.github.io/Capr/reference/cs.html" class="external-link">cs</a></span><span class="op">(</span><span class="fu">Capr</span><span class="fu">::</span><span class="fu"><a href="https://ohdsi.github.io/Capr/reference/cs.html" class="external-link">descendants</a></span><span class="op">(</span><span class="fl">1123627</span><span class="op">)</span>, name <span class="op">=</span> <span class="st">"sglt2"</span><span class="op">)</span>,</span>
<span>  <span class="fu">Capr</span><span class="fu">::</span><span class="fu"><a href="https://ohdsi.github.io/Capr/reference/cs.html" class="external-link">cs</a></span><span class="op">(</span><span class="fu">Capr</span><span class="fu">::</span><span class="fu"><a href="https://ohdsi.github.io/Capr/reference/cs.html" class="external-link">descendants</a></span><span class="op">(</span><span class="fl">1123618</span><span class="op">)</span>, name <span class="op">=</span> <span class="st">"glp1"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># make each time window</span></span>
<span><span class="va">tw1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="../reference/timeInterval.html">timeInterval</a></span><span class="op">(</span>lb <span class="op">=</span> <span class="op">-</span><span class="fl">365</span>, rb <span class="op">=</span> <span class="op">-</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">tw2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="../reference/timeInterval.html">timeInterval</a></span><span class="op">(</span>lb <span class="op">=</span> <span class="fl">0</span>, rb <span class="op">=</span> <span class="fl">90</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="../reference/timeInterval.html">timeInterval</a></span><span class="op">(</span>lb <span class="op">=</span> <span class="fl">0</span>, rb <span class="op">=</span> <span class="fl">365</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># define table shell</span></span>
<span><span class="va">ts2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/createTableShell.html">createTableShell</a></span><span class="op">(</span></span>
<span>  title <span class="op">=</span> <span class="st">"Demo 1"</span>,</span>
<span>  targetCohorts <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="../reference/createCohortInfo.html">createCohortInfo</a></span><span class="op">(</span>id <span class="op">=</span> <span class="fl">1</span>, name <span class="op">=</span> <span class="st">"Type 2 Diabetes"</span><span class="op">)</span></span>
<span>  <span class="op">)</span>,</span>
<span>  lineItems <span class="op">=</span> <span class="fu"><a href="../reference/lineItems.html">lineItems</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="../reference/addDefaultGenderLineItems.html">addDefaultGenderLineItems</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="../reference/addDefaultEthnicityLineItems.html">addDefaultEthnicityLineItems</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="../reference/createDemographicLineItem.html">createDemographicLineItem</a></span><span class="op">(</span><span class="fu"><a href="../reference/raceCategory.html">raceCategory</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="../reference/createDemographicLineItem.html">createDemographicLineItem</a></span><span class="op">(</span><span class="fu"><a href="../reference/ageCharCts.html">ageCharCts</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="../reference/createDemographicLineItem.html">createDemographicLineItem</a></span><span class="op">(</span><span class="fu"><a href="../reference/ageCharBreaks.html">ageCharBreaks</a></span><span class="op">(</span>breaks <span class="op">=</span> <span class="fu"><a href="../reference/age5yrGrp.html">age5yrGrp</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="../reference/createConceptSetLineItemBatch.html">createConceptSetLineItemBatch</a></span><span class="op">(</span></span>
<span>      sectionLabel <span class="op">=</span> <span class="st">"Baseline Conditions"</span>,</span>
<span>      domain <span class="op">=</span> <span class="st">"condition_occurrence"</span>,</span>
<span>      statistic <span class="op">=</span> <span class="fu"><a href="../reference/anyPresenceStat.html">anyPresenceStat</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>      conceptSets <span class="op">=</span> <span class="va">condition_cs</span>,</span>
<span>      timeIntervals <span class="op">=</span> <span class="va">tw1</span></span>
<span>    <span class="op">)</span>,</span>
<span>    <span class="fu"><a href="../reference/createConceptSetLineItemBatch.html">createConceptSetLineItemBatch</a></span><span class="op">(</span></span>
<span>      sectionLabel <span class="op">=</span> <span class="st">"Post-Index Drugs"</span>,</span>
<span>      domain <span class="op">=</span> <span class="st">"drug_exposure"</span>,</span>
<span>      statistic <span class="op">=</span> <span class="fu"><a href="../reference/anyPresenceStat.html">anyPresenceStat</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>      conceptSets <span class="op">=</span> <span class="va">drug_cs</span>,</span>
<span>      timeIntervals <span class="op">=</span> <span class="va">tw2</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/generateTableShell.html">generateTableShell</a></span><span class="op">(</span><span class="va">ts2</span>, <span class="va">executionSettings</span><span class="op">)</span></span>
<span><span class="va">res</span><span class="op">$</span><span class="va">categorical</span></span>
<span><span class="va">res</span><span class="op">$</span><span class="va">continuous</span></span></code></pre></div>
<p>In this version of the table shell we have grouped drugs and
conditions as a batch to deploy all combinations of the concept set and
time interval combinations. As for the demographics we add a convenience
function to include all basic gender items (male and female), ethnicity
categories (Hispanic, not Hispanic, and not reported), and race items
(“American Indian or Alaska Native”, “Asian”, “Black or African
American”, “Native Hawaiian or Other Pacific Islander”, “White”, and
“Unknown or Other”). In addition to the continuous age statistic from
the example above, we apply our first instance of a breaks strategy,
turning age into 5-year age groups. A convenience function is used that
automatically sets the breaks for the user.</p>
<p>Note: when a user generates the table shell a log of the shell is
printed out for review. Users may also review the table shell meta
information to understand the aspects of each line item using the
following method of the table shell class, which returns a tibble of
information.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ts2</span><span class="op">$</span><span class="fu">getTableShellMeta</span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="batch-functions">Batch functions<a class="anchor" aria-label="anchor" href="#batch-functions"></a>
</h3>
<p>When using <strong>multiple concepts and/or multiple time
intervals</strong> within a line item, we must use one of the Batch
functions:</p>
<ul>
<li><code>createCohortLineItemBatch</code></li>
<li><code>createConceptSetLineItemBatch</code></li>
<li><code>createSourceConceptSetLineItemBatch</code></li>
</ul>
<p>The batch functions create combinations of each of the concept sets
and/or time intervals for the corresponding statistic. For example, the
<code>createConceptSetLineItemBatch</code> for “Post-Index Drugs” in
table shell ts2 above will calculate <code>anyPresenceStat</code>
measures for every combination of the two drug concept sets in drug_cs,
“sglt2” and “glp1”, and the two time intervals in tw2. This results in 4
rows of measures in total for “Post-Index Drugs”.</p>
</div>
<div class="section level3">
<h3 id="cohorts-to-describe">Cohorts to Describe<a class="anchor" aria-label="anchor" href="#cohorts-to-describe"></a>
</h3>
<p>Sometimes we are interested in cohorts as items to characterize in a
table shell. For example, say we wanted to describe persons with heart
failure who also have ckd (at baseline). This is more easily done as a
cohort rather than a concept set because we have to apply logic to the
population.</p>
<p>In order to use cohorts in characterization, users must <a href="https://ohdsi.github.io/CohortGenerator/articles/GeneratingCohorts.html" class="external-link">generate
the cohort</a> in a cohort table in their workDatabaseSchema prior to
usage. Assuming that is done, adding this feature into the table shell
is quite simple.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">ClinicalCharacteristics</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Define Execution Settings</span></span>
<span><span class="va">executionSettings</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/createExecutionSettings.html">createExecutionSettings</a></span><span class="op">(</span></span>
<span>  connectionDetails <span class="op">=</span> <span class="va">connectionDetails</span>,</span>
<span>  cdmDatabaseSchema <span class="op">=</span> <span class="st">"omop_schema"</span>,</span>
<span>  workDatabaseSchema <span class="op">=</span> <span class="st">"my_schema"</span>,</span>
<span>  tempEmulationSchema <span class="op">=</span> <span class="st">"my_schema"</span>,</span>
<span>  cohortTable <span class="op">=</span> <span class="st">"my_cohorts"</span>,</span>
<span>  cdmSourceName <span class="op">=</span> <span class="st">"my_omop"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># create each concept set</span></span>
<span><span class="va">condition_cs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  <span class="fu">Capr</span><span class="fu">::</span><span class="fu"><a href="https://ohdsi.github.io/Capr/reference/cs.html" class="external-link">cs</a></span><span class="op">(</span><span class="fu">Capr</span><span class="fu">::</span><span class="fu"><a href="https://ohdsi.github.io/Capr/reference/cs.html" class="external-link">descendants</a></span><span class="op">(</span><span class="fl">46271022</span><span class="op">)</span>, name <span class="op">=</span> <span class="st">"ckd"</span><span class="op">)</span>,</span>
<span>  <span class="fu">Capr</span><span class="fu">::</span><span class="fu"><a href="https://ohdsi.github.io/Capr/reference/cs.html" class="external-link">cs</a></span><span class="op">(</span><span class="fu">Capr</span><span class="fu">::</span><span class="fu"><a href="https://ohdsi.github.io/Capr/reference/cs.html" class="external-link">descendants</a></span><span class="op">(</span><span class="fl">316139</span><span class="op">)</span>, name <span class="op">=</span> <span class="st">"hf"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">drug_cs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  <span class="fu">Capr</span><span class="fu">::</span><span class="fu"><a href="https://ohdsi.github.io/Capr/reference/cs.html" class="external-link">cs</a></span><span class="op">(</span><span class="fu">Capr</span><span class="fu">::</span><span class="fu"><a href="https://ohdsi.github.io/Capr/reference/cs.html" class="external-link">descendants</a></span><span class="op">(</span><span class="fl">1123627</span><span class="op">)</span>, name <span class="op">=</span> <span class="st">"sglt2"</span><span class="op">)</span>,</span>
<span>  <span class="fu">Capr</span><span class="fu">::</span><span class="fu"><a href="https://ohdsi.github.io/Capr/reference/cs.html" class="external-link">cs</a></span><span class="op">(</span><span class="fu">Capr</span><span class="fu">::</span><span class="fu"><a href="https://ohdsi.github.io/Capr/reference/cs.html" class="external-link">descendants</a></span><span class="op">(</span><span class="fl">1123618</span><span class="op">)</span>, name <span class="op">=</span> <span class="st">"glp1"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">covCohorts</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="../reference/createCohortInfo.html">createCohortInfo</a></span><span class="op">(</span>id <span class="op">=</span> <span class="fl">3</span>, name <span class="op">=</span> <span class="st">"HF with CKD at baseline"</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="../reference/createCohortInfo.html">createCohortInfo</a></span><span class="op">(</span>id <span class="op">=</span> <span class="fl">4</span>, name <span class="op">=</span> <span class="st">"Obesity with CKD at baseline"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># make each time window</span></span>
<span><span class="va">tw1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="../reference/timeInterval.html">timeInterval</a></span><span class="op">(</span>lb <span class="op">=</span> <span class="op">-</span><span class="fl">365</span>, rb <span class="op">=</span> <span class="op">-</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">tw2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="../reference/timeInterval.html">timeInterval</a></span><span class="op">(</span>lb <span class="op">=</span> <span class="fl">0</span>, rb <span class="op">=</span> <span class="fl">90</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="../reference/timeInterval.html">timeInterval</a></span><span class="op">(</span>lb <span class="op">=</span> <span class="fl">0</span>, rb <span class="op">=</span> <span class="fl">365</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># define table shell</span></span>
<span><span class="va">ts3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/createTableShell.html">createTableShell</a></span><span class="op">(</span></span>
<span>  title <span class="op">=</span> <span class="st">"Demo 1"</span>,</span>
<span>  targetCohorts <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="../reference/createCohortInfo.html">createCohortInfo</a></span><span class="op">(</span>id <span class="op">=</span> <span class="fl">1</span>, name <span class="op">=</span> <span class="st">"Type 2 Diabetes"</span><span class="op">)</span></span>
<span>  <span class="op">)</span>,</span>
<span>  lineItems <span class="op">=</span> <span class="fu"><a href="../reference/lineItems.html">lineItems</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="../reference/addDefaultGenderLineItems.html">addDefaultGenderLineItems</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="../reference/addDefaultEthnicityLineItems.html">addDefaultEthnicityLineItems</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="../reference/createDemographicLineItem.html">createDemographicLineItem</a></span><span class="op">(</span><span class="fu"><a href="../reference/raceCategory.html">raceCategory</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="../reference/createDemographicLineItem.html">createDemographicLineItem</a></span><span class="op">(</span><span class="fu"><a href="../reference/ageCharCts.html">ageCharCts</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="../reference/createDemographicLineItem.html">createDemographicLineItem</a></span><span class="op">(</span><span class="fu"><a href="../reference/ageCharBreaks.html">ageCharBreaks</a></span><span class="op">(</span>breaks <span class="op">=</span> <span class="fu"><a href="../reference/age5yrGrp.html">age5yrGrp</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="../reference/createConceptSetLineItemBatch.html">createConceptSetLineItemBatch</a></span><span class="op">(</span></span>
<span>      sectionLabel <span class="op">=</span> <span class="st">"Baseline Conditions"</span>,</span>
<span>      domain <span class="op">=</span> <span class="st">"condition_occurrence"</span>,</span>
<span>      statistic <span class="op">=</span> <span class="fu"><a href="../reference/anyPresenceStat.html">anyPresenceStat</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>      conceptSets <span class="op">=</span> <span class="va">condition_cs</span>,</span>
<span>      timeIntervals <span class="op">=</span> <span class="va">tw1</span></span>
<span>    <span class="op">)</span>,</span>
<span>    <span class="fu"><a href="../reference/createConceptSetLineItemBatch.html">createConceptSetLineItemBatch</a></span><span class="op">(</span></span>
<span>      sectionLabel <span class="op">=</span> <span class="st">"Post-Index Drugs"</span>,</span>
<span>      domain <span class="op">=</span> <span class="st">"drug_exposure"</span>,</span>
<span>      statistic <span class="op">=</span> <span class="fu"><a href="../reference/anyPresenceStat.html">anyPresenceStat</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>      conceptSets <span class="op">=</span> <span class="va">drug_cs</span>,</span>
<span>      timeIntervals <span class="op">=</span> <span class="va">tw2</span></span>
<span>    <span class="op">)</span>,</span>
<span>    <span class="fu"><a href="../reference/createCohortLineItemBatch.html">createCohortLineItemBatch</a></span><span class="op">(</span></span>
<span>      sectionLabel <span class="op">=</span> <span class="st">"Baseline Cohorts"</span>,</span>
<span>      covariateCohorts <span class="op">=</span> <span class="va">covCohorts</span>,</span>
<span>      cohortTable <span class="op">=</span> <span class="st">"my_cohort_table"</span>,</span>
<span>      timeIntervals <span class="op">=</span> <span class="va">tw1</span>,</span>
<span>      statistic <span class="op">=</span> <span class="fu"><a href="../reference/anyPresenceStat.html">anyPresenceStat</a></span><span class="op">(</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/generateTableShell.html">generateTableShell</a></span><span class="op">(</span><span class="va">ts3</span>, <span class="va">executionSettings</span><span class="op">)</span></span>
<span><span class="va">res</span><span class="op">$</span><span class="va">categorical</span></span>
<span><span class="va">res</span><span class="op">$</span><span class="va">continuous</span></span></code></pre></div>
<p>We use <code>createCohortInfo</code> to make CohortInfo class
objects, then assign the CohortInfo objects to the variable covCohorts
as a list. Then we set the covariateCohorts parameter of
<code>createCohortLineItemBatch</code> equal to our list of CohortInfo
objects (called covCohorts in the above example). In the
<code>createCohortlineItem</code> or
<code>CreateCohortLineItemBatch</code> calls we must specify into which
table these cohorts are instantiated.</p>
</div>
<div class="section level3">
<h3 id="concept-set-groups">Concept Set Groups<a class="anchor" aria-label="anchor" href="#concept-set-groups"></a>
</h3>
<p>Sometimes clinical events can be described in multiple domains.
Smoking, for example, has concepts in the observation and procedure
occurrence tables. It is easiest to handle multiple domains as a concept
set group where we specify each domain in which to look for our concept
set. The code below creates a concept set group line item that can be
added to a table shell.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">smoking_cs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  <span class="fu">Capr</span><span class="fu">::</span><span class="fu"><a href="https://ohdsi.github.io/Capr/reference/cs.html" class="external-link">cs</a></span><span class="op">(</span><span class="fu">Capr</span><span class="fu">::</span><span class="fu"><a href="https://ohdsi.github.io/Capr/reference/cs.html" class="external-link">descendants</a></span><span class="op">(</span><span class="fl">761009</span><span class="op">)</span>, name <span class="op">=</span> <span class="st">"Smoking Assessment"</span><span class="op">)</span>,</span>
<span>  <span class="fu">Capr</span><span class="fu">::</span><span class="fu"><a href="https://ohdsi.github.io/Capr/reference/cs.html" class="external-link">cs</a></span><span class="op">(</span><span class="fu">Capr</span><span class="fu">::</span><span class="fu"><a href="https://ohdsi.github.io/Capr/reference/cs.html" class="external-link">descendants</a></span><span class="op">(</span><span class="fl">44804450</span><span class="op">)</span>, name <span class="op">=</span> <span class="st">"Smoking Cessation"</span><span class="op">)</span>,</span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">csg</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/createConceptSetGroupLineItem.html">createConceptSetGroupLineItem</a></span><span class="op">(</span></span>
<span>  groupLabel <span class="op">=</span> <span class="st">"Smoking"</span>,</span>
<span>  conceptSets <span class="op">=</span> <span class="va">smoking_cs</span>,</span>
<span>  domainTables <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"procedure_occurrence"</span>, <span class="st">"observation"</span><span class="op">)</span>,</span>
<span>  statistic <span class="op">=</span> <span class="fu"><a href="../reference/anyPresenceStat.html">anyPresenceStat</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  timeInterval <span class="op">=</span> <span class="fu"><a href="../reference/timeInterval.html">timeInterval</a></span><span class="op">(</span>lb <span class="op">=</span> <span class="op">-</span><span class="fl">365</span>, rb <span class="op">=</span> <span class="op">-</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>Notice we specify the domain for each element of the concept set
list. When enumerating this will collapse into one category instead of
two items.</p>
</div>
<div class="section level3">
<h3 id="breaks">Breaks<a class="anchor" aria-label="anchor" href="#breaks"></a>
</h3>
<p>It is very common to want to convert a continuous summary into a
categorical summary. Say we want to know how many persons took 1, 2, 3,
or 4+ of a medication like sglt2 or glp1s, instead of how many took at
least one of these drugs at any time. To do this we must make a breaks
strategy.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">drug_cs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  <span class="fu">Capr</span><span class="fu">::</span><span class="fu"><a href="https://ohdsi.github.io/Capr/reference/cs.html" class="external-link">cs</a></span><span class="op">(</span><span class="fu">Capr</span><span class="fu">::</span><span class="fu"><a href="https://ohdsi.github.io/Capr/reference/cs.html" class="external-link">descendants</a></span><span class="op">(</span><span class="fl">1123627</span><span class="op">)</span>, name <span class="op">=</span> <span class="st">"sglt2"</span><span class="op">)</span>,</span>
<span>  <span class="fu">Capr</span><span class="fu">::</span><span class="fu"><a href="https://ohdsi.github.io/Capr/reference/cs.html" class="external-link">cs</a></span><span class="op">(</span><span class="fu">Capr</span><span class="fu">::</span><span class="fu"><a href="https://ohdsi.github.io/Capr/reference/cs.html" class="external-link">descendants</a></span><span class="op">(</span><span class="fl">1123618</span><span class="op">)</span>, name <span class="op">=</span> <span class="st">"glp1"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">tw2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="../reference/timeInterval.html">timeInterval</a></span><span class="op">(</span>lb <span class="op">=</span> <span class="fl">0</span>, rb <span class="op">=</span> <span class="fl">90</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="../reference/timeInterval.html">timeInterval</a></span><span class="op">(</span>lb <span class="op">=</span> <span class="fl">0</span>, rb <span class="op">=</span> <span class="fl">365</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">br</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/newValueBreaks.html">newValueBreaks</a></span><span class="op">(</span></span>
<span>  name <span class="op">=</span> <span class="st">"Medication Groups"</span>,</span>
<span>  breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">3</span>,<span class="fl">4</span><span class="op">)</span>,</span>
<span>  labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"one"</span>, <span class="st">"two"</span>, <span class="st">"three"</span>, <span class="st">"four or more"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">drugBreaks</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/createConceptSetLineItemBatch.html">createConceptSetLineItemBatch</a></span><span class="op">(</span></span>
<span>  sectionLabel <span class="op">=</span> <span class="st">"Drug CountBreaks"</span>,</span>
<span>  domain <span class="op">=</span> <span class="st">"drug_exposure"</span>,</span>
<span>  statistic <span class="op">=</span> <span class="fu"><a href="../reference/anyCountBreaksStat.html">anyCountBreaksStat</a></span><span class="op">(</span>breaks <span class="op">=</span> <span class="va">br</span><span class="op">)</span>,</span>
<span>  conceptSets <span class="op">=</span> <span class="va">drug_cs</span>,</span>
<span>  timeIntervals <span class="op">=</span> <span class="va">tw2</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>Once you have built this line item batch it can be added into the
table shell. Instead of providing a continuous summary, these will now
be broken into categories as specified in the
<code>newValueBreaks</code> function. If we actually wanted the
continuous summary the code would look as follows:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">drug_cs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  <span class="fu">Capr</span><span class="fu">::</span><span class="fu"><a href="https://ohdsi.github.io/Capr/reference/cs.html" class="external-link">cs</a></span><span class="op">(</span><span class="fu">Capr</span><span class="fu">::</span><span class="fu"><a href="https://ohdsi.github.io/Capr/reference/cs.html" class="external-link">descendants</a></span><span class="op">(</span><span class="fl">1123627</span><span class="op">)</span>, name <span class="op">=</span> <span class="st">"sglt2"</span><span class="op">)</span>,</span>
<span>  <span class="fu">Capr</span><span class="fu">::</span><span class="fu"><a href="https://ohdsi.github.io/Capr/reference/cs.html" class="external-link">cs</a></span><span class="op">(</span><span class="fu">Capr</span><span class="fu">::</span><span class="fu"><a href="https://ohdsi.github.io/Capr/reference/cs.html" class="external-link">descendants</a></span><span class="op">(</span><span class="fl">1123618</span><span class="op">)</span>, name <span class="op">=</span> <span class="st">"glp1"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">tw2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="../reference/timeInterval.html">timeInterval</a></span><span class="op">(</span>lb <span class="op">=</span> <span class="fl">0</span>, rb <span class="op">=</span> <span class="fl">90</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="../reference/timeInterval.html">timeInterval</a></span><span class="op">(</span>lb <span class="op">=</span> <span class="fl">0</span>, rb <span class="op">=</span> <span class="fl">365</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">drugCts</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/createConceptSetLineItemBatch.html">createConceptSetLineItemBatch</a></span><span class="op">(</span></span>
<span>  sectionLabel <span class="op">=</span> <span class="st">"Drug Count Continuous"</span>,</span>
<span>  domain <span class="op">=</span> <span class="st">"drug_exposure"</span>,</span>
<span>  statistic <span class="op">=</span> <span class="fu"><a href="../reference/anyCountCtsStat.html">anyCountCtsStat</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  conceptSets <span class="op">=</span> <span class="va">drug_cs</span>,</span>
<span>  timeIntervals <span class="op">=</span> <span class="va">tw2</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="review-the-sql">Review the Sql<a class="anchor" aria-label="anchor" href="#review-the-sql"></a>
</h3>
<p><code>ClinicalCharacteristics</code> works by serializing the input
of the TableShell object into a sql script that is run against the
database connection. Sometimes users may want to review the sql to
either check its quality or modify it slightly. We provide a function to
save the script designed by the program as a <code>.sql</code> that can
be opened in any code or text editor.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/reviewTableShellSql.html">reviewTableShellSql</a></span><span class="op">(</span><span class="va">ts</span>, <span class="va">executionSettings</span>, saveName <span class="op">=</span> <span class="st">"my_ts"</span>, savePath <span class="op">=</span> <span class="fu">here</span><span class="fu">::</span><span class="fu"><a href="https://here.r-lib.org/reference/here.html" class="external-link">here</a></span><span class="op">(</span><span class="st">"output"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="using-source-concepts">Using source concepts<a class="anchor" aria-label="anchor" href="#using-source-concepts"></a>
</h3>
<p>In certain circumstances, researchers might need to use source
concepts instead of standardized codes. However, the recommendation is
always to use standardized codes.</p>
</div>
<div class="section level3">
<h3 id="searching-the-codes">Searching the codes<a class="anchor" aria-label="anchor" href="#searching-the-codes"></a>
</h3>
<p>On occasion we can find the OHDSI concept id using the function
<code>lookupSourceConcepts</code>. For instance, we would like to use
the ICD10CM codes: ‘I45.81’, ‘I47’, ‘I49’, ’I49.40 to build a
<em>Cardiac Arrhythmia</em> concept set as follows:</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ca_source</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/lookupSourceConcepts.html">lookupSourceConcepts</a></span><span class="op">(</span></span>
<span>  codes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'I45.81'</span>, <span class="st">'I47'</span>, <span class="st">'I49'</span>, <span class="st">'I49.40'</span><span class="op">)</span>,</span>
<span>  vocabulary <span class="op">=</span> <span class="st">"ICD10CM"</span>,</span>
<span>  <span class="va">executionSettings</span></span>
<span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/sourceConceptSet.html">sourceConceptSet</a></span><span class="op">(</span>name <span class="op">=</span> <span class="st">"Cardiac Arrhythmia"</span><span class="op">)</span></span></code></pre></div>
<p>Then the table shell will look like the following:</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tw1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/timeInterval.html">timeInterval</a></span><span class="op">(</span>lb <span class="op">=</span> <span class="op">-</span><span class="fl">365</span>, rb <span class="op">=</span> <span class="op">-</span><span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span><span class="va">tssc</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/createTableShell.html">createTableShell</a></span><span class="op">(</span></span>
<span>  title <span class="op">=</span> <span class="st">"Demo 1"</span>,</span>
<span>  targetCohorts <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="../reference/createCohortInfo.html">createCohortInfo</a></span><span class="op">(</span>id <span class="op">=</span> <span class="fl">1</span>, name <span class="op">=</span> <span class="st">"Type 2 Diabetes"</span><span class="op">)</span></span>
<span>  <span class="op">)</span>,</span>
<span>  lineItems <span class="op">=</span> <span class="fu"><a href="../reference/lineItems.html">lineItems</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="../reference/addDefaultGenderLineItems.html">addDefaultGenderLineItems</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="../reference/addDefaultEthnicityLineItems.html">addDefaultEthnicityLineItems</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="../reference/createDemographicLineItem.html">createDemographicLineItem</a></span><span class="op">(</span><span class="fu"><a href="../reference/ageCharCts.html">ageCharCts</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="../reference/createDemographicLineItem.html">createDemographicLineItem</a></span><span class="op">(</span><span class="fu"><a href="../reference/ageCharBreaks.html">ageCharBreaks</a></span><span class="op">(</span>breaks <span class="op">=</span> <span class="fu"><a href="../reference/age5yrGrp.html">age5yrGrp</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="../reference/createSourceConceptSetLineItem.html">createSourceConceptSetLineItem</a></span><span class="op">(</span></span>
<span>      sectionLabel <span class="op">=</span> <span class="st">"Source Concept Conditions Cardiac Arrhythmia"</span>,</span>
<span>      domain <span class="op">=</span> <span class="st">"condition_occurrence"</span>,</span>
<span>      sourceConceptSets <span class="op">=</span> <span class="va">ca_source</span>,</span>
<span>      timeIntervals <span class="op">=</span> <span class="va">tw1</span>,</span>
<span>      statistic <span class="op">=</span> <span class="fu"><a href="../reference/anyPresenceStat.html">anyPresenceStat</a></span><span class="op">(</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="reading-source-concept-from-json-files">Reading source concept from Json files<a class="anchor" aria-label="anchor" href="#reading-source-concept-from-json-files"></a>
</h3>
<p>It is also possible to build the source concept set in ATLAS in a
Json format. Then, we can read the file using Capr’s functions as
follows:</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ca_source</span> <span class="op">&lt;-</span> <span class="fu">Capr</span><span class="fu">::</span><span class="fu"><a href="https://ohdsi.github.io/Capr/reference/readConceptSet.html" class="external-link">readConceptSet</a></span><span class="op">(</span>path <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">inputFolder</span>, <span class="st">"Cardiac Arrhythmia_in_icd.json"</span><span class="op">)</span>, name <span class="op">=</span> <span class="st">"Cardiac Arrhythmia"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">ca_source</span> <span class="op">&lt;-</span> <span class="fu">Capr</span><span class="fu">::</span><span class="fu">as.data.frame</span><span class="op">(</span><span class="va">ca_source</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">conceptId</span>, <span class="va">conceptName</span>, <span class="va">conceptCode</span>, <span class="va">vocabularyId</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/sourceConceptSet.html">sourceConceptSet</a></span><span class="op">(</span>name <span class="op">=</span> <span class="st">"Cardiac Arrhythmia"</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Martin Lavallee, Katy Sadowski, Ajit Londhe.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
